name: Unzip WhatsApp Auth

on:
  push:
    branches: [ "main" ]

jobs:
  unzip-auth:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Install unzip
        run: apt-get update && apt-get install -y unzip

      - name: Check for ZIP file
        run: |
          if [ -f "wwebjs_auth.zip" ]; then
            echo "✅ Found wwebjs_auth.zip"
          else
            echo "❌ ZIP not found. Stopping workflow."
            exit 1
          fi

      - name: Unzip Auth Folder
        run: |
          rm -rf .wwebjs_auth
          unzip -o wwebjs_auth.zip -d .wwebjs_auth
          echo "✅ ZIP extracted to .wwebjs_auth folder"

      - name: Commit Unzipped Folder
        run: |
          git config user.email "actions@github.com"
          git config user.name "GitHub Actions"
          git add .wwebjs_auth
          git commit -m "Auto-extracted WhatsApp Auth Folder" || echo "No changes to commit"
          git push || echo "No changes to push"
